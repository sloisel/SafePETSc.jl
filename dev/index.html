<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SafePETSc.jl</title><meta name="title" content="Home · SafePETSc.jl"/><meta property="og:title" content="Home · SafePETSc.jl"/><meta property="twitter:title" content="Home · SafePETSc.jl"/><meta name="description" content="Documentation for SafePETSc.jl."/><meta property="og:description" content="Documentation for SafePETSc.jl."/><meta property="twitter:description" content="Documentation for SafePETSc.jl."/><meta property="og:url" content="https://sloisel.github.io/SafePETSc.jl/"/><meta property="twitter:url" content="https://sloisel.github.io/SafePETSc.jl/"/><link rel="canonical" href="https://sloisel.github.io/SafePETSc.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SafePETSc.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Quick-Example"><span>Quick Example</span></a></li><li><a class="tocitem" href="#Package-Architecture"><span>Package Architecture</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Getting-Started"><span>Getting Started</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="getting_started/">Getting Started</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="guide/distributed_refs/">Distributed Reference Management</a></li><li><a class="tocitem" href="guide/vectors/">Vectors</a></li><li><a class="tocitem" href="guide/matrices/">Matrices</a></li><li><a class="tocitem" href="guide/solvers/">Linear Solvers</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="api/safempi/">SafeMPI</a></li><li><a class="tocitem" href="api/vectors/">Vectors</a></li><li><a class="tocitem" href="api/matrices/">Matrices</a></li><li><a class="tocitem" href="api/solvers/">Solvers</a></li></ul></li><li><a class="tocitem" href="developer/">Developer Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SafePETSc.jl"><a class="docs-heading-anchor" href="#SafePETSc.jl">SafePETSc.jl</a><a id="SafePETSc.jl-1"></a><a class="docs-heading-anchor-permalink" href="#SafePETSc.jl" title="Permalink"></a></h1><p>SafePETSc is a Julia package that provides distributed reference management for MPI-based parallel computing with PETSc. The core purpose is to safely manage the lifecycle of distributed objects across MPI ranks, ensuring objects are destroyed only when all ranks have released their references.</p><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><ul><li><strong>Automatic Memory Management</strong>: Distributed objects are automatically tracked and released when all MPI ranks have released their references</li><li><strong>GPU-Friendly Operations</strong>: Prioritizes PETSc&#39;s native GPU-compatible operations</li><li><strong>Type-Safe API</strong>: Uses Julia&#39;s trait system to ensure only appropriate types are managed</li><li><strong>Efficient Cleanup</strong>: Centralized cleanup with configurable throttling to reduce overhead</li><li><strong>Rich Linear Algebra</strong>: Comprehensive support for distributed vectors, matrices, and solvers</li></ul><h2 id="Quick-Example"><a class="docs-heading-anchor" href="#Quick-Example">Quick Example</a><a id="Quick-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using SafePETSc
using MPI

# Initialize MPI and PETSc
SafePETSc.Init()

# Create a distributed matrix
A = Mat_uniform([2.0 1.0; 1.0 3.0])

# Create a distributed vector
b = Vec_uniform([1.0, 2.0])

# Solve the linear system
x = A \ b

# Objects are automatically cleaned up when they go out of scope</code></pre><h2 id="Package-Architecture"><a class="docs-heading-anchor" href="#Package-Architecture">Package Architecture</a><a id="Package-Architecture-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Architecture" title="Permalink"></a></h2><p>SafePETSc consists of two main modules:</p><h3 id="SafeMPI"><a class="docs-heading-anchor" href="#SafeMPI">SafeMPI</a><a id="SafeMPI-1"></a><a class="docs-heading-anchor-permalink" href="#SafeMPI" title="Permalink"></a></h3><p>The <code>SafeMPI</code> module implements the distributed reference management system:</p><ul><li><strong><code>DRef{T}</code></strong>: A distributed reference wrapper that tracks objects across MPI ranks</li><li><strong><code>DistributedRefManager</code></strong>: Each rank allocates IDs deterministically, mirrors reference counters and the shared <code>free_ids</code> pool, and performs collective cleanup via Allgather/Allgatherv</li><li><strong>Trait-based destruction</strong>: Types must opt-in to distributed management</li><li><strong>Automatic cleanup</strong>: Finalizers enqueue releases locally; <code>check_and_destroy!</code> performs GC and collective Allgather at safe points</li></ul><h3 id="SafePETSc"><a class="docs-heading-anchor" href="#SafePETSc">SafePETSc</a><a id="SafePETSc-1"></a><a class="docs-heading-anchor-permalink" href="#SafePETSc" title="Permalink"></a></h3><p>The main module wraps PETSc functionality with safe distributed reference management:</p><ul><li><strong><code>Vec{T}</code></strong>: Distributed vectors with automatic memory management and pooling (vectors are returned to a reuse pool by default)</li><li><strong><code>Mat{T}</code></strong>: Distributed matrices with GPU-friendly operations</li><li><strong><code>Solver{T}</code></strong>: Linear solver objects that can be reused</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;SafePETSc&quot;)</code></pre><h2 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h2><p>See the <a href="getting_started/">Getting Started</a> guide for a tutorial on using SafePETSc.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="api/safempi/#SafePETSc.SafeMPI.default_manager"><code>SafePETSc.SafeMPI.default_manager</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.enable_assert"><code>SafePETSc.SafeMPI.enable_assert</code></a></li><li><a href="api/matrices/#SafePETSc.Mat"><code>SafePETSc.Mat</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.CanDestroy"><code>SafePETSc.SafeMPI.CanDestroy</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.CannotDestroy"><code>SafePETSc.SafeMPI.CannotDestroy</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.DRef"><code>SafePETSc.SafeMPI.DRef</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.DestroySupport"><code>SafePETSc.SafeMPI.DestroySupport</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.DistributedRefManager"><code>SafePETSc.SafeMPI.DistributedRefManager</code></a></li><li><a href="api/solvers/#SafePETSc.Solver"><code>SafePETSc.Solver</code></a></li><li><a href="api/vectors/#SafePETSc.Vec"><code>SafePETSc.Vec</code></a></li><li><a href="api/matrices/#Base.cat"><code>Base.cat</code></a></li><li><a href="api/matrices/#Base.hcat"><code>Base.hcat</code></a></li><li><a href="api/matrices/#Base.vcat"><code>Base.vcat</code></a></li><li><a href="api/solvers/#SafePETSc.Init"><code>SafePETSc.Init</code></a></li><li><a href="api/solvers/#SafePETSc.Initialized"><code>SafePETSc.Initialized</code></a></li><li><a href="api/matrices/#SafePETSc.Mat_sum"><code>SafePETSc.Mat_sum</code></a></li><li><a href="api/matrices/#SafePETSc.Mat_uniform"><code>SafePETSc.Mat_uniform</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.check_and_destroy!"><code>SafePETSc.SafeMPI.check_and_destroy!</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.destroy_obj!"><code>SafePETSc.SafeMPI.destroy_obj!</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.destroy_trait"><code>SafePETSc.SafeMPI.destroy_trait</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.mpi_any"><code>SafePETSc.SafeMPI.mpi_any</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.mpierror"><code>SafePETSc.SafeMPI.mpierror</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.set_assert"><code>SafePETSc.SafeMPI.set_assert</code></a></li><li><a href="api/vectors/#SafePETSc.Vec_sum"><code>SafePETSc.Vec_sum</code></a></li><li><a href="api/vectors/#SafePETSc.Vec_uniform"><code>SafePETSc.Vec_uniform</code></a></li><li><a href="api/vectors/#SafePETSc.default_row_partition"><code>SafePETSc.default_row_partition</code></a></li><li><a href="api/vectors/#SafePETSc.fill_like"><code>SafePETSc.fill_like</code></a></li><li><a href="api/vectors/#SafePETSc.ones_like"><code>SafePETSc.ones_like</code></a></li><li><a href="api/solvers/#SafePETSc.petsc_options_insert_string"><code>SafePETSc.petsc_options_insert_string</code></a></li><li><a href="api/vectors/#SafePETSc.zeros_like"><code>SafePETSc.zeros_like</code></a></li><li><a href="api/matrices/#SparseArrays.blockdiag"><code>SparseArrays.blockdiag</code></a></li><li><a href="api/matrices/#SparseArrays.spdiagm"><code>SparseArrays.spdiagm</code></a></li><li><a href="api/safempi/#SafePETSc.SafeMPI.@mpiassert"><code>SafePETSc.SafeMPI.@mpiassert</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="getting_started/">Getting Started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 11 November 2025 12:02">Tuesday 11 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
